---
title: "Part #2: Enhanced security in Artix"
description: "The second part of my Artix Linux guide"
author: "LÃ©o Mercier"
authorLink: "https://github.com/Sawangg"
authorAt: "@Sawangg"
publishedAt: 2024-02-08
tags:
- title: Linux
  color: orange
- title: Guide
  color: red
---

If you followed [the previous post](/posts/guide-to-artix), you should now have a barebone system. It is still better than 90% of computer used today (thanks Microsoft) but we're still vulnerable to all kind of attacks. In this chapter, we're going to increase our security before configuring our user environment in a next post.

***

## Firewall

Once you're back in your system, login as a user. I assume you know what a firewall is all about so we're going to install one called `nftables`. You could just configure your `iptables` to create the same rules.
```sh
sudo pacman -S nftables nftables-dinit
```

Edit and comment the tcp sshd line
```sh
sudo vim /etc/nftables.conf
```

And enable the service by running
```sh
dinitctl enable nftables
```

You can now see the rules used currently
```sh
sudo nft list ruleset
```

***

## Kernel parameters

We already installed the hardened version of the Linux kernel so we just have to tweak a few network kernel parameters
```sh
sudo mkdir /etc/sysctl.d/
sudo vim /etc/sysctl.d/99-network.conf
```

Add this config
```sh
# Do not act as a router
net.ipv4.ip_forward = 0

# SYN flood protection
net.ipv4.tcp_syncookies = 1

# Disable ICMP redirect
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.default.secure_redirects = 0

# Don't send ICMP redirects
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0
```

Finally apply your changes by running
```sh
sysctl --system
```

### Disable ipv6

If you want to disable ipv6 you can do so by creating the file `/etc/sysctl.d/40-ipv6.conf` and add this config
```sh
# Disable IPv6
net.ipv6.conf.all.disable_ipv6 = 1
```

Don't forget to reload your config

You also need to edit your dhcpcd config located at `/etc/dhcpcd.conf`
```
noipv6rs
noipv6
```

You can check that you don't have any ipv6 left in your interfaces
```sh
ip -c addr
```

You can now test pinging something with ipv6. It should fail!
```sh
ping -6 wiki.archlinux.org
```

## MAC address & Host randomization

The MAC address of an interface is a unique identifier that can be used to track us. We're going to randomize it when we boot our system. To achieve that, we can install a GNU package called `macchager`
```sh
yay -S macchanger-git
```

Next we're going to create a `udev` rule called `81-mac-spoof.rules` and paste this
```sh
ACTION=="add", SUBSYSTEM=="net", ATTR{address}=="original MAC of interface", RUN+="/usr/bin/macchanger -r interfaceName"
```

The `original MAC of interface` is the orginal address of your interface and `interfaceName` is the name of the interface. You can find both by running
```
ip -c addr
```

You can add a new line for each interface your PC has but do not change your `lo` MAC adress. Now, each time you reboot you'll get a new MAC address!

